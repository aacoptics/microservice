<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aacoptics.pack.mapper.ShipmentBatchInfoMapper">
    <select id="getShipmentBatchInfoPage" resultType="com.aacoptics.pack.entity.po.ShipmentBatchInfo">
        select
            a.customer,
            d.customer_material_no,
            b.batch_name,
            d.supplier,
            d.secrity_code as outer_box,
            d.qty as outer_box_qty,
            d.print_time as outer_box_time,
            b.secrity_code as spot_ticket,
            b.qty as spot_qty,
            b.print_datetime as spot_time
        FROM [LabelPrint_NE].[dbo].[t_package_bound_info] a
                 join t_spot_ticket_print_information b
                      on (a.customer = b.customer or b.customer='CR')
                          and a.spot_ticket = b.product_batch
                 left  join t_middle_large_ticket_print_information d
                            on a.customer = d.customer
                                and a.large_ticket = d.shipment_batch
                                and d.label_type = 3
        where a.status > 0
          and isnull(a.large_ticket,'') != ''
          and d.order_no = #{orderNo}
          AND a.customer= #{customer}
    </select>

    <select id="getShipmentBatchInfo" resultType="com.aacoptics.pack.entity.po.ShipmentBatchInfo">
        select
            a.customer,
            d.customer_material_no customer_material_no,
            b.batch_name,
            d.supplier as supplier,
            d.secrity_code as outer_box,
            d.qty as outer_box_qty,
            d.print_time as outer_box_time,
            b.secrity_code as spot_ticket,
            b.qty as spot_qty,
            b.print_datetime as spot_time
        FROM [LabelPrint_NE].[dbo].[t_package_bound_info] a
                 join t_spot_ticket_print_information b
                      on (a.customer = b.customer or b.customer='CR')
                          and a.spot_ticket = b.product_batch
                 left  join t_middle_large_ticket_print_information d
                            on a.customer = d.customer
                                and a.large_ticket = d.shipment_batch
                                and d.label_type = 3
        WHERE a.status > 0
          and isnull(a.large_ticket,'') != ''
          AND d.order_no = #{orderNo}
          AND a.customer= #{customer}
        order by outer_box
    </select>
</mapper>